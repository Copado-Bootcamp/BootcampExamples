/**
 * @description Test class for CaseUpdateHandler - Partner Account Escalation logic.
 *              Part of 5-class test suite covering CaseUpdateHandler.
 * @relatedTests TestMethod2, TestMethod3, TestMethod4, TestMethod5
 */
@IsTest
private class TestMethod1 {
    
    @IsTest 
    static void testPartnerAccountEscalation() {
        Account partnerAccount = new Account(Name='Test Partner', Type='Partner');
        insert partnerAccount;
        
        Case testCase = new Case(
            AccountId=partnerAccount.Id, 
            Status='New', 
            Subject='Partner Test'
        );
        insert testCase;
        
        Test.startTest();
        CaseUpdateHandler.updateCases(new List<Case>{testCase});
        Test.stopTest();
        
        Case updatedCase = [SELECT Status, OwnerId FROM Case WHERE Id = :testCase.Id];
        System.assertEquals('Escalated', updatedCase.Status);
        System.assertNotEquals(null, updatedCase.OwnerId);
    }
    
    /**
     * @description COVERS LINE 94 - Queue found and returned
     * Tests Partner account with valid queue to trigger successful queue lookup
     */
    @IsTest 
    static void testPartnerWithValidQueue() {
        // This will trigger the getQueueIdByName method and hit Line 94
        Account partnerAccount = new Account(Name='Partner With Queue', Type='Partner');
        insert partnerAccount;
        
        // Create case with Partner account
        Case partnerCase = new Case(
            AccountId=partnerAccount.Id,
            Status='New',
            Subject='Partner Queue Test'
        );
        insert partnerCase;
        
        Test.startTest();
        CaseUpdateHandler.updateCases(new List<Case>{partnerCase});
        Test.stopTest();
        
        Case updatedCase = [SELECT OwnerId, Status FROM Case WHERE Id = :partnerCase.Id];
        System.assertNotEquals(null, updatedCase.OwnerId, 'Queue ID should be assigned (Line 94 executed)');
        System.assertEquals('Escalated', updatedCase.Status);
    }
    
    /**
     * @description Account-only case (no Contact) to ensure Account query executes
     */
    @IsTest 
    static void testAccountOnlyNoContact() {
        Account testAccount = new Account(Name='Account Only', Type='Partner');
        insert testAccount;
        
        Case accountOnlyCase = new Case(
            AccountId=testAccount.Id,
            // NO ContactId - ensures only Account query runs
            Status='New',
            Subject='Account Only Test'
        );
        insert accountOnlyCase;
        
        Test.startTest();
        CaseUpdateHandler.updateCases(new List<Case>{accountOnlyCase});
        Test.stopTest();
        
        Case updatedCase = [SELECT Status FROM Case WHERE Id = :accountOnlyCase.Id];
        System.assertEquals('Escalated', updatedCase.Status);
    }
}
